<!DOCTYPE html>
<html>
  <head> </head>
  <body>
    <div>
      <div style="display: flex">
        <div style="display: flex" id="grid-container">
          <div id="leftrow"></div>
          <div id="midrow"></div>
          <div id="rightrow"></div>
        </div>
        <button id="tombol-roll">klik</button>
      </div>
    </div>
    <script>
      function createNewElement(transformX) {
        const outcome = Math.floor(Math.random() * 3);
          let img;
          if (outcome === 0) img = "./segitiga.png";
          if (outcome === 1) img = "./kotak.png";
          if (outcome === 2) img = "./bunder.png";
          const newElement = document.createElement("img");
          newElement.style.width = "150px";
          newElement.style.position = "absolute";
          newElement.style.transform = `translate(0px, ${transformX}px)`;
          newElement.style.transition = "all 0.1s linear";
          newElement.src = img;
          return newElement;
      }

      /**
       * INITIALIZATION
       */
      const left = document.getElementById("leftrow");
      const mid = document.getElementById("midrow");
      const right = document.getElementById("rightrow");

      const cols = [left, mid, right];
      const gridContainer = document.getElementById("grid-container");

      const SQUARE_LENGTH = 170;

      gridContainer.style.width = `${SQUARE_LENGTH * 3}px`;
      gridContainer.style.height = `${SQUARE_LENGTH * 3}px`;
      cols.forEach((v) => {
        v.style.display = "flex";
        v.style.flexDirection = "column";
        v.style.position = "relative";
        v.style.width = `${SQUARE_LENGTH}px`;

        for (let i = 0; i < 3; i++) {
          const newElement = createNewElement(i * SQUARE_LENGTH);
          v.appendChild(newElement);
        }
      });

      /**
       * TOMBOL
       */
      const tombolRoll = document.getElementById("tombol-roll");
      tombolRoll.addEventListener("click", (e) => {
        cols.forEach((col, i) => {
          setTimeout(() => {
            const childs = [...col.children];

            const newElement = createNewElement(-1 * SQUARE_LENGTH);
            col.appendChild(newElement)
            setTimeout(() => {
              setTimeout(() => {
                newElement.style.transform = "translate(0px, 0px)";
              }, 0);
            }, 0);

            childs.forEach((child) => {
              const translate = child.style.transform
                .replace("translate(0px, ", "")
                .replace("px)", "");
              const newTranslate =
                (+translate + SQUARE_LENGTH) % (SQUARE_LENGTH * 3);
              child.style.transform = `translate(0px, ${newTranslate}px)`;
              if (newTranslate < translate) {
                child.remove();
              }
            });
          }, 200 * i);
        });
      });
    </script>
  </body>
</html>
